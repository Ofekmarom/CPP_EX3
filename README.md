# קטאן - מטלה 3
המתיישבים של קטאן הוא משחק קופסא ל-3-4 שחקנים המשלב הן חשיבה אסטרטגית, ניהול משאבים ויכולת מסחר. מטרת המשחק היא לצבור ראשון 10 נקודות ניצחון.
את הוראות המשחק המלא ניתן למצוא כאן: https://www.hakubia.com/wp-content/uploads/2021/01/%D7%A7%D7%98%D7%90%D7%9F.pdf.
במטלה אני מממש גרסה פשוטה יותר של המשחק עבור 3 שחקנים.
## חוקי המשחק
המשחק מורכב מלוח המכיל 19 חלקות אדמה בצורת משושה מוקפות בים. כל חלקת אדמה נותנת משאב כלשהו (חוץ מהמדבר). חלקות האדמה במשחק הן: יער (מניב עץ), גבעות (מניבות לבנים), אדמת מרעה (מניבה צמר), אדמה חקלאית (מניבה שיבולת), הרים (מניבים ברזל), מדבר (לא מניב כלום).
כל חלקי המפה מקבלים מספר כלשהו בין 2 ל-12 חוץ מהמדבר שהוא עם המספר 0. 
### קלפים, יישובים, ערים ומשאבים
כל שחקן בעל משאבים (כגון שיבולת, ברזל, לבנים וכו') יכול לרכוש איתם דברים שונים במשחק כמו קלפי פיתוח, יישובים, ערים ודרכים.
- קלף פיתוח: מחירו של קלף פיתוח הוא ברזל 1, צמר 1 ושיבולת 1. 
סוגי הקלפים:
1. מונופול - יש 2 קלפים כאלה במשחק, השחקן בוחר משאב כלשהו וכל שאר השחקנים מחוייבים להעביר לו את המשאב הזה. 
2. בניית דרכים - יש 2 קלפים כאלה במשחק,השחקן יכול לבנות 2 דרכים במפה ללא עלות. 
3. שנת שפע - יש 2 קלפים כאלה במשחק, השחקן זוכה לקבל מהבנק שני משאבים לבחירה. 
4. אבירים - יש 3 קלפים כאלה במשחק, שחקן המחזיק ב-3 קלפים כאלה, נחשב בעל הצבא הגדול ביותר שנותן לו 2 נקודות ניצחון (אם איבד אביר אחד, הקלף נלקח מהשחקן. 
קלף
5. נקודות ניצחון - יש 4 קלפים כאלה במשחק המעניקים נקודת ניצחון למי שמחזיק בהם.

- בנייה: ניתן לבנות דרכים, ערים ויישובים בצורה הבאה:
1. קטע דרך: עלותו לבנים 1 ועץ 1. קטע דרך יכול להיות מחובר רק ליישוב (או עיר) בבעלות השחקן או לקטע דרך נוסף.
2. יישוב: עלות היישוב היא לבנה 1, עץ 1, צמר 1 ושיבולת 1. ניתן לבנות יישוב על צומת שאליה מובילה דרך אחת לפחות ומברחק של 2 קטעי דרך מיישוב אחר. בניית יישוב מקנה לשחקן נקודת ניצחון אחת.
3. עיר: עיר יכולה להחליף יישוב קיים. עלות הבנייה היא ברזל 3 ושיבולת 2. ברגע שמשדרגים יישוב לעיר, השחקן מקבל נקודה נוספת על השדרוג. עיר מעניקה לשחקן פי-2 יותר משאבים מכל חבלי הארץ הסמוכים לה.

- משאבים: כאמור, המשאבים מתקבלים מחבלי הארץ השונים. כאשר שחקן מטיל את קוביות המשחק, כל השחקנים מקבלים משאבים בהתאם למספר שיצא בהטלה 
- מסחר: שחקנים יכולים לבצע מסחר ביניהם (כלומר להחליף קלפים או משאבים).
### מהלך המשחק
כל שחקן מתחיל את המשחק עם 2 יישובים ו-2 קטעי דרך המעניקים לו 2 נקודות ניצחון. בנוסף, השחקנים מקבלים משאבים התחלתיים בהתאם למקומות שבהם הם מיקמו את היישובים (משאב אחד מכל משאב אפשרי).
בכל תור השחקנים מטילים 2 קוביות. בהתאם לתוצאת ההטלה, השחקנים מקבלים משאבים כמו שפורט מקודם.
שחקן בתור נתון יכול לעשות את הפעולות הבאות:
- הוא יכול לסחור.
- הוא יכול לבנות דרכים, יישובים או ערים ויכול לקנות קלפי פיתוח.
  אם השחקן מנצל את אחד מקלפי הפיתוח שברשותו, התור אוטומטית עובר לשחקן הבא.
  אם סכום ההטלה הוא 7, על כל השחקנים בעלי יותר מ-7 משאבים לבחור מחצית מהקלפים ולהחזיר אותם לערימה.
  
### סיום המשחק
המשחק מסתיים בתור שבו אחד השחקנים הגיע ל-10 או יותר נקודות ניצחון. כדי לנצח במשחק, השחקן צריך שיגיע תורו ובאותו התור יהיו לו 10 נקודות לכל הפחות.



### המימוש של לוח המשחק אצלי: 
לוח המשחק בנוי מ19 משושים,54 קודקודים ו72 צלעות שממוספרים על ידי ID וניתן לראות את המספרים האלה בתמונה שצירפתי למטלה של הלוח שלי.
לכל קודקוד יש: ID, שחקן שנחשב הבעלים שלו, סוג מבנה שקיים עליו, משתנה בוליאני ששומר אם הקודקוד תפוס או פנוי, וקטור של קודקודים שכנים, וקטור של צלעות שיוצאות מהקודקוד, וקטור של משושים שהקודקוד נמצא בסמוך אליהם.
לכל צלע יש:  ID, שחקן שנחשב הבעלים שלו, משתנה בוליאני ששומר אם הצלע תפוסה או פנויה, קודקוד ראשון, קודקוד שני.
לכל משושה יש: ID, סוג אדמה, סוג משאב, המספר שעל המשושה, וקטור של קודקודים השייכים אליו, וקטור של צלעות השייכות אליו.


### מימוש המשחק והשחקן:
יש לי את המחלקות catan,player שבהם אני מממש את לוגיקת המשחק ואת החוקים. 
במחלקה קטאן יש את הפעולות הבאות:
Catan(const vector<Player*>& players - בנאי המקבל וקטור של שחקנים

chooseStartingPlayer();//the first player in the vector of players start the game
getCurrentPlayer();//return the player that this is his turn
nextPlayer();//set the turn to the next player
rollDice();//roll the dice

giveStartingResources();//give resources to players based on the strating settlements of the players

printWinner() const;//function to print the points for every player and if there is winner

Board& getBoard() ; - מחזיר את הלוח של המשחק

drawDevelopmentCard();//function to draw development card from the deck when a player buys development card
handleMonopol(Player& player, Hexagon::ResourceType chosenResource);//function for monopol development card

getDevelopmentCardsCatan();//returns the deck of the cards




במחלקה שחקן יש את הפעולות הבאות:
getName() - מחזיר את שם השחקן
getVictoryPoints() - מחזיר את מספק נקודות הניצחון של השחקן
getnumOfResources(); - מחזיר את מספר המשאבים של השחקן
getnumOfKnights(); - מחזיר את מספר האבירים של השחקן
rollDice(Catan& catan); - לזרוק את הקוביות
startTurn(); - להתחיל את התור של השחקן
endTurn(Catan& catan); - לסיים את התור של השחקן
getMyTurn(); - מחזיר אם זה תור השחקן או לא
getIsLargestArmy(); - מחזיר אם לשחקן יש את הצבא הכי גדול
addResource(Hexagon::ResourceType type, int amount); - מוסיף סוג מסויים של משאב
removeResource(Hexagon::ResourceType type, int amount); - מוריד סוג מסוים של משאב
getResourceAmount(Hexagon::ResourceType type); - מחזיר את כמות המשאב שיש לשחקן ממשאב מסויים
getResources(); - מחזיר את כל המשאבים של השחקן
hasResources( map<Hexagon::ResourceType, int>& cost) - מחזיר האם לשחקן קיים את המשאבים האלה
buildStartingSettlement(int vertexId, Board* board); - בניית יישוב התחלתי
buildStartingRoad(int edgeId, Board* board); - בניית דרך התחלתית
buildSettlement(int vertexId, Board* board); - בניית יישוב
buildRoad(int edgeId, Board* board); - בניית דרך
buildCity(int vertexId, Board* board); - בניית עיר
buyDevelopmentCard(Catan& catan); - קניית קלף פיתוח
useDevelopmentCard(DevelopmentCard::Type type, Catan& catan); - שימוש בקלף פיתוח
chooseMinResource(); - פונקציה לבחירת המשאב המינימלי אצל השחקן בשביל  שימוש בקלפים מונופול וקלף שנת שפע 
chooseEdgeForRoadBuild(Board* board); - פונקציה לבחירת צלע פנויה לפי החוקים בשביל שימוש בקלף: בניית דרכים
tradeResources(Player* other, Hexagon::ResourceType giveResourceType, int giveAmount, Hexagon::ResourceType receiveResourceType, int receiveAmount); - החלפת משאבים בין שחקנים
tradeDevelopmentCards(Player* other, DevelopmentCard::Type giveCardType, DevelopmentCard::Type receiveCardType); - החלפת קלף פיתוח בין שחקנים
getSettlements(); - מחזיר את היישובים של השחקן
getDevelopmentCards(); - מחזיר את קלפי הפיתוח של השחקן
getRoads(); - מחזיר את הדרכים של השחקן
getCities(); - מחזיר את הערים של השחקן





בנוסף,כתבתי גם את המחלקה test.cpp שבה ביצעתי בדיקות של הרבה מקרים שונים ושל הפעולות הקיימות במשחק על מנת לוודא שהמשחק שמימשתי עובד כמו שצריך לפי חוקי המשחק שקיבלנו.


ספריות שהשתמשתי:
<iostream> , <vector> , <cstdlib> , <ctime> , <algorithm> , <string> , <stdexcept> , <map> 


###הרצת התוכנית:
כדי להריץ את התוכנית כותבים בטרמינל את הפקודה make all ולאחר מכן כותבים בטרמינל או make catan כדי להריץ את קובץ הדמו או make runtest כדי להריץ את קובץ הטסטים.



